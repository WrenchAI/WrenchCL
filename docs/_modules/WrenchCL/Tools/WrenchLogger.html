<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WrenchCL.Tools.WrenchLogger &mdash; WrenchCL  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            WrenchCL
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../WrenchCL.html">WrenchCL package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../setup.html">setup module</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">WrenchCL</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">WrenchCL.Tools.WrenchLogger</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for WrenchCL.Tools.WrenchLogger</h1><div class="highlight"><pre>
<span></span><span class="c1">#  Copyright (c) $YEAR$. Copyright (c) $YEAR$ Wrench.AI., Willem van der Schans, Jeong Kim</span>
<span class="c1">#</span>
<span class="c1">#  MIT License</span>
<span class="c1">#</span>
<span class="c1">#  Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the &quot;Software&quot;), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</span>
<span class="c1">#</span>
<span class="c1">#  The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</span>
<span class="c1">#</span>
<span class="c1">#  THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</span>
<span class="c1">#</span>
<span class="c1">#  All works within the Software are owned by their respective creators and are distributed by Wrench.AI.</span>
<span class="c1">#</span>
<span class="c1">#  For inquiries, please contact Willem van der Schans through the official Wrench.AI channels or directly via GitHub at [Kydoimos97](https://github.com/Kydoimos97).</span>
<span class="c1">#</span>

<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">date</span>
<span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
<span class="kn">from</span> <span class="nn">textwrap</span> <span class="kn">import</span> <span class="n">fill</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">colorama</span> <span class="kn">import</span> <span class="n">init</span><span class="p">,</span> <span class="n">Fore</span> <span class="k">as</span> <span class="n">ColoramaFore</span><span class="p">,</span> <span class="n">Style</span> <span class="k">as</span> <span class="n">ColoramaStyle</span>

    <span class="n">colorama_imported</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">colorama_imported</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;colorama package not found. Colored logging is disabled.&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="LoggerSingleton">
<a class="viewcode-back" href="../../../WrenchCL.Tools.html#WrenchCL.Tools.WrenchLogger.LoggerSingleton">[docs]</a>
<span class="k">def</span> <span class="nf">LoggerSingleton</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decorator for a class to implement the Singleton pattern. This decorator ensures that only one instance of the</span>
<span class="sd">    decorated class can exist at any time. If an instance of the class already exists, it returns that instance;</span>
<span class="sd">    otherwise, it creates and returns a new instance.</span>

<span class="sd">    The Singleton pattern is particularly useful when exactly one object is needed to coordinate actions across the</span>
<span class="sd">    system, such as in the case of managing database connections.</span>

<span class="sd">    :param cls: The class to be decorated as a Singleton.</span>
<span class="sd">    :type cls: type</span>
<span class="sd">    :returns: A wrapper function that manages the instantiation of the singleton class, ensuring that only one</span>
<span class="sd">              instance exists.</span>
<span class="sd">    :rtype: function</span>

<span class="sd">    **Example**::</span>

<span class="sd">        &gt;&gt;&gt; @SingletonClass</span>
<span class="sd">        ... class DatabaseManager:</span>
<span class="sd">        ...     def __init__(self, connection_string):</span>
<span class="sd">        ...         self.connection_string = connection_string</span>
<span class="sd">        ...</span>
<span class="sd">        &gt;&gt;&gt; db_manager1 = DatabaseManager(&#39;db_connection_string&#39;)</span>
<span class="sd">        &gt;&gt;&gt; db_manager2 = DatabaseManager(&#39;db_connection_string&#39;)</span>
<span class="sd">        &gt;&gt;&gt; assert db_manager1 is db_manager2  # Both variables point to the same instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">instances</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">get_instance</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the singleton instance of the class, creating it if it does not already exist.</span>

<span class="sd">        :param args: Positional arguments for the class constructor.</span>
<span class="sd">        :param kwargs: Keyword arguments for the class constructor.</span>
<span class="sd">        :returns: The singleton instance of the class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">cls</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">instances</span><span class="p">[</span><span class="bp">cls</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">instances</span><span class="p">[</span><span class="bp">cls</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">get_instance</span></div>




<span class="nd">@LoggerSingleton</span>
<span class="k">class</span> <span class="nc">_wrench_logger</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;INFO&#39;</span><span class="p">,</span> <span class="n">file_logging</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">file_name_append_mode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_start_time</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_run_id</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">running_on_lambda</span> <span class="o">=</span> <span class="s1">&#39;AWS_LAMBDA_FUNCTION_NAME&#39;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">previous_level</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_logging</span> <span class="o">=</span> <span class="n">file_logging</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_format</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logging_level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_logging_level</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_logging</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_filename</span><span class="p">(</span><span class="n">file_name_append_mode</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_handler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_configure_file_handler</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_handler</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console_handler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_configure_console_handler</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_logger</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">force_stack_trace</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">addLevelName</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="s2">&quot;CONTEXT&quot;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">addLevelName</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="s2">&quot;HDL_WARN&quot;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">addLevelName</span><span class="p">(</span><span class="mi">41</span><span class="p">,</span> <span class="s2">&quot;DATA&quot;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">addLevelName</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="s2">&quot;HDL_ERR&quot;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">addLevelName</span><span class="p">(</span><span class="mi">43</span><span class="p">,</span> <span class="s1">&#39;RCV_ERR&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">initiate_new_run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_run_id</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_generate_run_id</span><span class="p">():</span>
        <span class="c1"># Current date in YYMMDD format</span>
        <span class="n">date_seed</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%y%m</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 6 characters</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">date_seed</span><span class="p">)</span>
        <span class="n">random_part_1</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">6</span><span class="p">))</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">minute_second_seed</span> <span class="o">=</span> <span class="n">now</span><span class="o">.</span><span class="n">minute</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">+</span> <span class="n">now</span><span class="o">.</span><span class="n">second</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">minute_second_seed</span><span class="p">)</span>
        <span class="n">random_part_2</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;R-</span><span class="si">{</span><span class="n">random_part_1</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">random_part_2</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="nf">overwrite_lambda_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setting</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">running_on_lambda</span> <span class="o">=</span> <span class="n">setting</span>

    <span class="k">def</span> <span class="nf">set_global_traceback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setting</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">force_stack_trace</span> <span class="o">=</span> <span class="n">setting</span>

    <span class="k">def</span> <span class="nf">release_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Releases file handler resources.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_handler</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_handler</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">removeHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_handler</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Change the reporting level of the logger.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            level (str): The desired logging level as a string (e.g., &#39;DEBUG&#39;, &#39;INFO&#39;, &#39;WARNING&#39;, &#39;ERROR&#39;, &#39;CRITICAL&#39;).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">previous_level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">getEffectiveLevel</span><span class="p">()</span>
        <span class="n">numeric_level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_logging_level</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">numeric_level</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_handler</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">numeric_level</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">console_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">numeric_level</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logging_level</span> <span class="o">=</span> <span class="n">numeric_level</span>

    <span class="k">def</span> <span class="nf">revertLoggingLevel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">previous_level</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_handler</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">previous_level</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">previous_level</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logging_level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous_level</span>

    <span class="k">def</span> <span class="nf">set_file_logging</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_logging</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_logging</span> <span class="o">=</span> <span class="n">file_logging</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_logging</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">release_resources</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_logging</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_handler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_configure_file_handler</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_logger</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">set_log_file_location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_append_mode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Change the file append mode, copy content from the old file to the new one,</span>
<span class="sd">        and optionally delete the old file.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            new_append_mode (str): The new append mode for the log filename.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_logging</span> <span class="ow">and</span> <span class="n">new_append_mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Get the old file&#39;s name</span>
            <span class="n">old_filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span>

            <span class="c1"># Set the new append mode and update the filename</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_filename</span><span class="p">(</span><span class="n">new_append_mode</span><span class="p">)</span>

            <span class="c1"># Reconfigure file handler to use the new filename</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_reconfigure_file_handler</span><span class="p">()</span>

            <span class="c1"># Copy the content of the old file to the new one</span>
            <span class="k">if</span> <span class="n">old_filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">old_filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">old_file</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">new_file</span><span class="p">:</span>
                    <span class="n">new_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">old_file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
                <span class="c1"># Optionally, delete the old file</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">old_filename</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_logging</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_file_logging</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1"># Set the new append mode and update the filename</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_filename</span><span class="p">(</span><span class="n">new_append_mode</span><span class="p">)</span>
            <span class="c1"># Reconfigure file handler to use the new filename</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_reconfigure_file_handler</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="c1"># Main Functional Methods</span>
    <span class="k">def</span> <span class="nf">_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Initialize stack_level_index</span>
        <span class="n">stack_level_index</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">stack_trace</span> <span class="o">=</span> <span class="s2">&quot; --&gt; InternalLogFrames&quot;</span>
        <span class="n">last_level</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">write_flag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">match_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">filepath_out</span><span class="p">,</span> <span class="n">line_no_out</span><span class="p">,</span> <span class="n">func_name_out</span><span class="p">,</span> <span class="n">sinfo_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">findCaller</span><span class="p">(</span><span class="n">stack_info</span><span class="o">=</span><span class="n">stack_info</span><span class="p">,</span>
                                                                                     <span class="n">stacklevel</span><span class="o">=</span><span class="n">stack_level_index</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">stack_level_index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">first_index</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filepath_out</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">func_name_out</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">line_no_out</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="c1"># Loop to find the caller</span>
        <span class="k">while</span> <span class="n">stack_level_index</span><span class="p">:</span>
            <span class="n">filepath</span><span class="p">,</span> <span class="n">line_no</span><span class="p">,</span> <span class="n">func_name</span><span class="p">,</span> <span class="n">sinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">findCaller</span><span class="p">(</span><span class="n">stack_info</span><span class="o">=</span><span class="n">stack_info</span><span class="p">,</span>
                                                                         <span class="n">stacklevel</span><span class="o">=</span><span class="n">stack_level_index</span><span class="p">)</span>
            <span class="k">if</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">line_no</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">!=</span> <span class="n">last_level</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">line_no</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">!=</span> <span class="n">first_index</span> <span class="ow">or</span> <span class="n">stack_level_index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">match_counter</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">running_on_lambda</span><span class="p">:</span>
                    <span class="n">stack_trace</span> <span class="o">=</span> <span class="n">stack_trace</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; &lt;-- </span><span class="si">{</span><span class="n">stack_level_index</span><span class="si">}</span><span class="s2">|</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">line_no</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">stack_trace</span> <span class="o">=</span> <span class="n">stack_trace</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> -- </span><span class="si">{</span><span class="n">stack_level_index</span><span class="si">}</span><span class="s2">|</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">line_no</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">last_level</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">func_name</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">line_no</span><span class="si">}</span><span class="s2">&quot;</span>

                <span class="k">if</span> <span class="n">write_flag</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_internal_frame</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">filepath</span><span class="p">)):</span>
                    <span class="n">filepath_out</span><span class="p">,</span> <span class="n">line_no_out</span><span class="p">,</span> <span class="n">func_name_out</span><span class="p">,</span> <span class="n">sinfo_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">findCaller</span><span class="p">(</span><span class="n">stack_info</span><span class="o">=</span><span class="n">stack_info</span><span class="p">,</span>
                                                                                                 <span class="n">stacklevel</span><span class="o">=</span><span class="n">stack_level_index</span><span class="p">)</span>
                    <span class="n">write_flag</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">match_counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_internal_frame</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">filepath</span><span class="p">))</span> <span class="ow">and</span> <span class="n">match_counter</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">:</span>
                <span class="n">stack_level_index</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="c1"># Handle stack_info</span>
        <span class="k">if</span> <span class="n">stack_info</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span> <span class="o">!=</span> <span class="s2">&quot;NoneType: None</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">colorama_imported</span><span class="p">:</span>
                    <span class="n">sinfo</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ---Stack Trace--- </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">ColoramaFore</span><span class="o">.</span><span class="n">LIGHTBLACK_EX</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">stack_trace</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">ColoramaFore</span><span class="o">.</span><span class="n">RESET</span><span class="si">}</span><span class="s2"> ---Python Traceback--- </span><span class="si">{</span><span class="n">ColoramaFore</span><span class="o">.</span><span class="n">LIGHTBLACK_EX</span><span class="si">}</span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">ColoramaFore</span><span class="o">.</span><span class="n">RESET</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sinfo</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ---Stack Trace--- </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">stack_trace</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2"> ---Python Traceback--- </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sinfo</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Stack Trace: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_format_data</span><span class="p">(</span><span class="n">stack_trace</span><span class="p">[</span><span class="mi">4</span><span class="p">:],</span><span class="w"> </span><span class="n">stack_trace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sinfo</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Create and handle the log record</span>
        <span class="n">record</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">makeRecord</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">,</span> <span class="n">fn</span><span class="o">=</span><span class="n">filepath_out</span><span class="p">,</span> <span class="n">lno</span><span class="o">=</span><span class="n">line_no_out</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">func_name_out</span><span class="p">,</span> <span class="n">sinfo</span><span class="o">=</span><span class="n">sinfo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">handle</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_log_with_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="n">stack_info</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">indent_prefix</span> <span class="o">=</span> <span class="s1">&#39;  --&gt;    &#39;</span>  <span class="c1"># Custom indent prefix for new lines</span>
        <span class="k">if</span> <span class="n">level</span> <span class="o">&lt;=</span> <span class="mi">15</span><span class="p">:</span>
            <span class="n">text_col</span> <span class="o">=</span> <span class="n">ColoramaFore</span><span class="o">.</span><span class="n">LIGHTWHITE_EX</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">text_col</span> <span class="o">=</span> <span class="n">ColoramaFore</span><span class="o">.</span><span class="n">WHITE</span>

        <span class="k">if</span> <span class="n">colorama_imported</span> <span class="ow">and</span> <span class="n">color</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">running_on_lambda</span><span class="p">:</span>
            <span class="c1"># Apply color to each line and indent new lines</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
            <span class="n">colored_lines</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
            <span class="n">colored_lines</span> <span class="o">+=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">text_col</span><span class="si">}{</span><span class="n">indent_prefix</span><span class="si">}{</span><span class="n">line</span><span class="si">}{</span><span class="n">ColoramaStyle</span><span class="o">.</span><span class="n">RESET_ALL</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">colored_lines</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handlerFormat</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">running_on_lambda</span><span class="p">:</span>

            <span class="c1"># Join lines with a separator for AWS Lambda</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handlerFormat</span><span class="p">()</span>  <span class="c1"># Use default handler format</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_handlerFormat</span><span class="p">()</span>  <span class="c1"># Use default handler format</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_stack_trace</span> <span class="ow">and</span> <span class="n">level</span> <span class="o">&gt;=</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">stack_info</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log information that might be helpful but isn&#39;t essential.&quot;&quot;&quot;</span>
        <span class="n">serialized_args</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_custom_serializer</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">serialized_args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_with_color</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">ColoramaFore</span><span class="o">.</span><span class="n">LIGHTGREEN_EX</span> <span class="k">if</span> <span class="n">colorama_imported</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">)</span>

    <span class="n">log_info</span> <span class="o">=</span> <span class="n">INFO</span> <span class="o">=</span> <span class="n">info</span>  <span class="c1"># Aliases for info</span>

    <span class="k">def</span> <span class="nf">context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log contextual information for better understanding of the flow.&quot;&quot;&quot;</span>
        <span class="n">serialized_args</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_custom_serializer</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">serialized_args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_with_color</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">ColoramaFore</span><span class="o">.</span><span class="n">LIGHTMAGENTA_EX</span> <span class="k">if</span> <span class="n">colorama_imported</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">)</span>

    <span class="n">log_context</span> <span class="o">=</span> <span class="n">CONTEXT</span> <span class="o">=</span> <span class="n">context</span>  <span class="c1"># Aliases for context</span>

    <span class="k">def</span> <span class="nf">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log issues that aren&#39;t errors but might warrant investigation.&quot;&quot;&quot;</span>
        <span class="n">serialized_args</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_custom_serializer</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">serialized_args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_with_color</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">ColoramaFore</span><span class="o">.</span><span class="n">YELLOW</span> <span class="k">if</span> <span class="n">colorama_imported</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">)</span>

    <span class="n">log_warning</span> <span class="o">=</span> <span class="n">WARNING</span> <span class="o">=</span> <span class="n">warning</span>  <span class="c1"># Aliases for warning</span>

    <span class="k">def</span> <span class="nf">HDL_WARN</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log warnings that have been handled and do not require further action.&quot;&quot;&quot;</span>
        <span class="n">serialized_args</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_custom_serializer</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">serialized_args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_with_color</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">ColoramaFore</span><span class="o">.</span><span class="n">MAGENTA</span> <span class="k">if</span> <span class="n">colorama_imported</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">)</span>

    <span class="n">log_handled_warning</span> <span class="o">=</span> <span class="n">log_hdl_warn</span> <span class="o">=</span> <span class="n">HDL_WARN</span>  <span class="c1"># Aliases for HDL_WARN</span>

    <span class="k">def</span> <span class="nf">error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log errors that could disrupt normal program flow.&quot;&quot;&quot;</span>
        <span class="n">serialized_args</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_custom_serializer</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">serialized_args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_with_color</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">ColoramaFore</span><span class="o">.</span><span class="n">RED</span> <span class="k">if</span> <span class="n">colorama_imported</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">)</span>

    <span class="n">log_error</span> <span class="o">=</span> <span class="n">ERROR</span> <span class="o">=</span> <span class="n">error</span>  <span class="c1"># Aliases for error</span>

    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">wrap_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">max_rows</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">stack_info</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">indent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log Data in a lower contrast, handling formatting for readability.&quot;&quot;&quot;</span>
        <span class="n">formatted_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">wrap_length</span><span class="p">,</span> <span class="n">max_rows</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">indent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_with_color</span><span class="p">(</span><span class="mi">41</span><span class="p">,</span> <span class="n">formatted_data</span><span class="p">,</span> <span class="n">ColoramaFore</span><span class="o">.</span><span class="n">LIGHTWHITE_EX</span> <span class="k">if</span> <span class="n">colorama_imported</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">)</span>

    <span class="n">log_data</span> <span class="o">=</span> <span class="n">print_data</span> <span class="o">=</span> <span class="n">DATA</span> <span class="o">=</span> <span class="n">data</span>

    <span class="k">def</span> <span class="nf">HDL_ERR</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log errors that have been handled but still need to be reported.&quot;&quot;&quot;</span>
        <span class="n">serialized_args</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_custom_serializer</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">serialized_args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_with_color</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">ColoramaFore</span><span class="o">.</span><span class="n">LIGHTMAGENTA_EX</span> <span class="k">if</span> <span class="n">colorama_imported</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">)</span>

    <span class="n">log_handled_error</span> <span class="o">=</span> <span class="n">log_hdl_err</span> <span class="o">=</span> <span class="n">HDL_ERR</span>  <span class="c1"># Aliases for HDL_ERR</span>

    <span class="k">def</span> <span class="nf">RECV_ERR</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log errors from which the system can recover with or without manual intervention.&quot;&quot;&quot;</span>
        <span class="n">serialized_args</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_custom_serializer</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">serialized_args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_with_color</span><span class="p">(</span><span class="mi">43</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">ColoramaFore</span><span class="o">.</span><span class="n">LIGHTRED_EX</span> <span class="k">if</span> <span class="n">colorama_imported</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">)</span>

    <span class="n">log_recoverable_error</span> <span class="o">=</span> <span class="n">log_recv_err</span> <span class="o">=</span> <span class="n">RECV_ERR</span>  <span class="c1"># Aliases for RECV_ERR</span>

    <span class="k">def</span> <span class="nf">critical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log critical issues that require immediate attention.&quot;&quot;&quot;</span>
        <span class="n">serialized_args</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_custom_serializer</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">serialized_args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_with_color</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">ColoramaFore</span><span class="o">.</span><span class="n">RED</span> <span class="k">if</span> <span class="n">colorama_imported</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">)</span>

    <span class="n">log_critical</span> <span class="o">=</span> <span class="n">CRITICAL</span> <span class="o">=</span> <span class="n">critical</span>  <span class="c1"># Aliases for critical</span>

    <span class="k">def</span> <span class="nf">debug</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log detailed information, typically of interest only when diagnosing problems.&quot;&quot;&quot;</span>
        <span class="n">serialized_args</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_custom_serializer</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">serialized_args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_with_color</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">ColoramaFore</span><span class="o">.</span><span class="n">CYAN</span> <span class="k">if</span> <span class="n">colorama_imported</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">)</span>

    <span class="n">log_debug</span> <span class="o">=</span> <span class="n">DEBUG</span> <span class="o">=</span> <span class="n">debug</span>  <span class="c1"># Aliases for debug</span>

    <span class="c1"># Formatting Methods</span>

    <span class="k">def</span> <span class="nf">_format_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">wrap_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stack_trace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">indent</span> <span class="o">=</span> <span class="mi">4</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Format data for logging, applying wrapping and color formatting where applicable.&quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">serialize</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">serialize</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">set</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">{</span><span class="n">serialize</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">}</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">obj</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_custom_serializer</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

        <span class="c1"># Determine the prefix based on the data type</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="n">pd</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">prefix_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;DataType: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> | Length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">formatted_text</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="n">indent</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_custom_serializer</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">pd</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">prefix_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;DataType: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> | Shape: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> rows | </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> columns&quot;</span>
            <span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">option_context</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="n">max_rows</span><span class="p">,</span> <span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="n">formatted_text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">set</span><span class="p">)):</span>
            <span class="n">prefix_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;DataType: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> | Length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">formatted_text</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="n">indent</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_custom_serializer</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">prefix_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;DataType: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> | Length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">formatted_text</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">serialize</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="n">indent</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_custom_serializer</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">content</span><span class="p">:</span>
            <span class="n">formatted_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">wrapped_text</span> <span class="o">=</span> <span class="n">formatted_text</span>
        <span class="k">elif</span> <span class="n">wrap_length</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">running_on_lambda</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">wrap_with_indent</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">wrap_length</span><span class="p">):</span>
                <span class="n">leading_whitespace</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())</span>
                <span class="n">wrapped_lines</span> <span class="o">=</span> <span class="n">fill</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">wrap_length</span><span class="p">,</span> <span class="n">subsequent_indent</span><span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="n">leading_whitespace</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">wrapped_lines</span>

            <span class="n">wrapped_text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">wrap_with_indent</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">wrap_length</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">formatted_text</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">wrapped_text</span> <span class="o">=</span> <span class="n">formatted_text</span>

        <span class="c1"># Add color and whitespace for visual distinction</span>
        <span class="k">if</span> <span class="n">colorama_imported</span> <span class="ow">and</span> <span class="n">color</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">running_on_lambda</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">stack_trace</span><span class="p">:</span>
                <span class="n">final_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">ColoramaFore</span><span class="o">.</span><span class="n">LIGHTBLUE_EX</span><span class="si">}{</span><span class="n">prefix_str</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">ColoramaFore</span><span class="o">.</span><span class="n">LIGHTBLACK_EX</span><span class="si">}{</span><span class="n">wrapped_text</span><span class="si">}{</span><span class="n">ColoramaFore</span><span class="o">.</span><span class="n">RESET</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">final_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">ColoramaFore</span><span class="o">.</span><span class="n">LIGHTBLACK_EX</span><span class="si">}{</span><span class="n">wrapped_text</span><span class="si">}{</span><span class="n">ColoramaFore</span><span class="o">.</span><span class="n">RESET</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">running_on_lambda</span><span class="p">:</span>
            <span class="n">final_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="si">{</span><span class="n">wrapped_text</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># In environments like AWS Lambda, where color might not be supported or desired</span>
            <span class="n">final_text</span> <span class="o">=</span> <span class="n">wrapped_text</span>

        <span class="k">return</span> <span class="n">final_text</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_custom_serializer</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;JSON serializer for objects not serializable by default JSON code&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="n">datetime</span><span class="p">,</span> <span class="n">date</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;__dict__&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__dict__</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">obj</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>  <span class="c1"># Fallback for other types</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_wrap_text</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">wrap_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">textwrap</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">wrap_length</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_log_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="n">newline</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Logs a header text, centered and separated by dashes.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            text (str): The header text.</span>
<span class="sd">            size (int, optional): The width of the header. Default is 80.</span>
<span class="sd">            newline (bool, optional): Whether to prepend a newline before the header. Default is True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">text</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_handler</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;%(message)s&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;%(message)s&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">newline</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">))</span>  <span class="c1"># Print header centered in 80 characters</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_handler</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_format</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_handlerFormat</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_handlerFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Configures the console handler&#39;s formatter with optional color.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            color (str, optional): The color code for colorama. Default is None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">colorama_imported</span> <span class="ow">and</span> <span class="n">color</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;hex_color_palette&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="ow">and</span> <span class="n">color</span> <span class="o">!=</span> <span class="n">ColoramaFore</span><span class="o">.</span><span class="n">LIGHTWHITE_EX</span><span class="p">:</span>
                <span class="n">reset_var</span> <span class="o">=</span> <span class="n">ColoramaStyle</span><span class="o">.</span><span class="n">RESET_ALL</span>
                <span class="n">white_col</span> <span class="o">=</span> <span class="n">ColoramaFore</span><span class="o">.</span><span class="n">LIGHTWHITE_EX</span>
                <span class="n">format_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s2">%(levelname)-8s:  [</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">run_id</span><span class="si">}</span><span class="s2">] %(filename)s:%(funcName)s:%(lineno)-4d | %(asctime)s | </span><span class="si">{</span><span class="n">white_col</span><span class="si">}</span><span class="s2">%(message)s </span><span class="si">{</span><span class="n">reset_var</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">elif</span> <span class="s1">&#39;hex_color_palette&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="ow">and</span> <span class="n">color</span> <span class="o">==</span> <span class="n">ColoramaFore</span><span class="o">.</span><span class="n">LIGHTWHITE_EX</span><span class="p">:</span>
                <span class="n">reset_var</span> <span class="o">=</span> <span class="n">ColoramaStyle</span><span class="o">.</span><span class="n">RESET_ALL</span>
                <span class="n">format_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s2">-----%(levelname)s----- %(message)s</span><span class="si">{</span><span class="n">reset_var</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">reset_var</span> <span class="o">=</span> <span class="n">ColoramaStyle</span><span class="o">.</span><span class="n">RESET_ALL</span>
                <span class="n">white_col</span> <span class="o">=</span> <span class="n">ColoramaFore</span><span class="o">.</span><span class="n">RESET</span>
                <span class="n">format_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s2">%(levelname)-8s: [</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">run_id</span><span class="si">}</span><span class="s2">] %(filename)s:%(funcName)s:%(lineno)-4d | %(asctime)s |</span><span class="si">{</span><span class="n">reset_var</span><span class="si">}</span><span class="s2"> </span><span class="se">\x1b</span><span class="s2">[38;20m %(message)s </span><span class="se">\x1b</span><span class="s2">[0m&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">format_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;%(levelname)-8s: [</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">run_id</span><span class="si">}</span><span class="s2">] %(filename)s:%(funcName)s:%(lineno)-4d | %(asctime)s | %(message)s&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">console_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="n">format_str</span><span class="p">,</span> <span class="n">datefmt</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_reconfigure_file_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reconfigure the file handler to use the updated filename.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Close and remove the old file handler</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_handler</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_handler</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">removeHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_handler</span><span class="p">)</span>

        <span class="c1"># Configure the new file handler with the updated filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_handler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_configure_file_handler</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_handler</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_handler</span><span class="p">)</span>

    <span class="c1"># Supplementary Methods</span>
    <span class="k">def</span> <span class="nf">header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="n">newline</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Logs a header, similar to `_log_header`, but intended for external use.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            text (str): The header text.</span>
<span class="sd">            size (int): The width of the header.</span>
<span class="sd">            newline (bool, optional): Whether to prepend a newline before the header. Default is True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_header</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">newline</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">compact_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">40</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="p">)</span>

    <span class="c1"># Private Utility Methods</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_is_internal_frame</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">check_strs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;WrenchLogger.py&#39;</span><span class="p">,</span> <span class="s1">&#39;_pytest&#39;</span><span class="p">]</span>
        <span class="n">end_strs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;__init__.py&#39;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">cstr</span> <span class="ow">in</span> <span class="n">check_strs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cstr</span> <span class="ow">in</span> <span class="n">filepath</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="k">for</span> <span class="n">estr</span> <span class="ow">in</span> <span class="n">end_strs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">filepath</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">estr</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_get_base_format</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a logging formatter with a specific format.</span>

<span class="sd">        Returns:</span>
<span class="sd">            logging.Formatter: A logging formatter with a predefined format and date format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;%(levelname)-8s: [</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">run_id</span><span class="si">}</span><span class="s2">]&quot;</span>
                                 <span class="sa">f</span><span class="s2">&quot;%(filename)s:%(funcName)s:%(lineno)d | &quot;</span>
                                 <span class="sa">f</span><span class="s2">&quot;%(asctime)s | &quot;</span>
                                 <span class="sa">f</span><span class="s2">&quot;%(message)s&quot;</span><span class="p">,</span> <span class="n">datefmt</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_set_logging_level</span><span class="p">(</span><span class="n">level</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts a logging level string to its corresponding logging level constant.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            level (str): The logging level as a string.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The logging level constant from the `logging` module.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">level</span> <span class="o">=</span> <span class="n">level</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;debug&quot;</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="s2">&quot;warning&quot;</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
                  <span class="s2">&quot;critical&quot;</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">level</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">levels</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid logging level: </span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">levels</span><span class="p">[</span><span class="n">level</span><span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_set_filename</span><span class="p">(</span><span class="n">file_name_append_mode</span><span class="p">:</span> <span class="n">Optional</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates the log file name based on the provided `file_name_append_mode`.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        file_name_append_mode (str or None): Additional information to append to the log file name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The log file name with a directory path.</span>
<span class="sd">    &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">find_project_root</span><span class="p">(</span><span class="n">anchor</span><span class="o">=</span><span class="s1">&#39;.git&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Finds the project root by searching for a specified anchor. If not found, returns the current working directory.&quot;&quot;&quot;</span>
            <span class="n">current_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
            <span class="k">while</span> <span class="n">current_dir</span> <span class="o">!=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">current_dir</span><span class="p">):</span>  <span class="c1"># Stop when reaching the root directory</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_dir</span><span class="p">,</span> <span class="n">anchor</span><span class="p">)):</span>
                    <span class="k">return</span> <span class="n">current_dir</span>
                <span class="n">current_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">current_dir</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

        <span class="n">root_folder</span> <span class="o">=</span> <span class="n">find_project_root</span><span class="p">()</span>
        <span class="n">log_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_folder</span><span class="p">,</span> <span class="s1">&#39;resources&#39;</span><span class="p">,</span> <span class="s1">&#39;logs&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">log_dir</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">log_dir</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">PermissionError</span><span class="p">:</span>
                <span class="n">log_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>  <span class="c1"># If creation of the log directory fails, use the current working directory</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="n">log_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">e</span>

        <span class="k">if</span> <span class="n">file_name_append_mode</span><span class="p">:</span>
            <span class="n">log_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">file_name_append_mode</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">root_folder</span> <span class="o">==</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">():</span>
            <span class="n">log_file_name</span> <span class="o">=</span> <span class="s1">&#39;python.log&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">-%H%M%S&#39;</span><span class="p">)</span>
            <span class="n">log_file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;log-</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s1">.log&#39;</span>

        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">log_dir</span><span class="p">,</span> <span class="n">log_file_name</span><span class="p">)</span>

    <span class="c1"># Configuration Methods</span>
    <span class="k">def</span> <span class="nf">_configure_file_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Configures and returns a file handler for logging.</span>

<span class="sd">        Returns:</span>
<span class="sd">            logging.FileHandler: Configured file handler for logging.</span>

<span class="sd">        Raises:</span>
<span class="sd">            PermissionError, FileNotFoundError: If an error occurs while setting up the file handler.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span>
                <span class="n">handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
                <span class="n">handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logging_level</span><span class="p">)</span>
                <span class="n">handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_format</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">handler</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">PermissionError</span><span class="p">,</span> <span class="ne">FileNotFoundError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error setting up file handler: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_configure_console_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Configures and returns a console handler for logging.</span>

<span class="sd">        Returns:</span>
<span class="sd">            logging.StreamHandler: Configured console handler for logging.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
        <span class="n">handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logging_level</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">handler</span>

    <span class="k">def</span> <span class="nf">_initialize_logger</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the logger with file and console handlers, and sets the logging level.</span>
<span class="sd">        Adjusts initialization based on the running environment.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logging_level</span><span class="p">)</span>

        <span class="c1"># Clear existing handlers in the AWS Lambda environment to avoid duplicates</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">running_on_lambda</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">handlers</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Clear existing handlers</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_logging</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_handler</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_handler</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">console_handler</span><span class="p">)</span>

        <span class="c1"># Initialize colorama for colorful output if not running on AWS Lambda</span>
        <span class="k">if</span> <span class="n">colorama_imported</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">running_on_lambda</span><span class="p">:</span>
            <span class="n">init</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">start_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start a timer for performance measurement.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">log_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Elapsed time&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;seconds&quot;</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Log the elapsed time since start_time() was called with an optional message.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">        - message: The message to prefix the time with.</span>
<span class="sd">        - format: The format to display the time in (&quot;seconds&quot; or &quot;formatted&quot;).</span>
<span class="sd">        - stack_info: Whether to include stack info.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_start_time&#39;</span><span class="p">):</span>
            <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_time</span>
            <span class="k">if</span> <span class="nb">format</span> <span class="o">==</span> <span class="s2">&quot;seconds&quot;</span><span class="p">:</span>
                <span class="n">time_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">elapsed_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span>
            <span class="k">elif</span> <span class="nb">format</span> <span class="o">==</span> <span class="s2">&quot;formatted&quot;</span><span class="p">:</span>
                <span class="c1"># Convert seconds to a timedelta object, then format as days, hours, minutes, and seconds</span>
                <span class="n">td</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed_time</span><span class="p">)</span>
                <span class="n">time_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">td</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid format specified for log_time(). Defaulting to seconds.&quot;</span><span class="p">)</span>
                <span class="n">time_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">elapsed_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">time_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">stack_info</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Timer was not started with start_time() before calling log_time().&quot;</span><span class="p">)</span>

    <span class="c1"># Alias for log_time</span>
    <span class="n">Time</span> <span class="o">=</span> <span class="n">log_time</span>


<span class="n">logger</span> <span class="o">=</span> <span class="n">_wrench_logger</span><span class="p">()</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Willem van der Schans.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>